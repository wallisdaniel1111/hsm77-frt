<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>HSM-77 Tactical PRT Planner</title>
    <link href="https://fonts.googleapis.com/css2?family=Oswald:wght@700&family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2pdf.js/0.10.1/html2pdf.bundle.min.js"></script>
    <style>
        :root { --navy: #001220; --gold: #c5a059; --red: #ff4d00; --bg: #f9f9fb; --border: #cbd5e1; }
        body { font-family: 'Inter', sans-serif; background: var(--bg); color: #0f172a; margin: 0; padding-bottom: 100px; }

        /* UI Styling */
        header { background: var(--navy); color: white; padding: 60px 20px; border-bottom: 8px solid var(--red); }
        .squadron { font-family: 'Oswald', sans-serif; color: var(--gold); letter-spacing: 3px; font-size: 0.8rem; text-transform: uppercase; }
        header h1 { font-family: 'Oswald', sans-serif; font-size: 2.8rem; margin: 0; text-transform: uppercase; }
        .container { max-width: 850px; margin: auto; padding: 20px; }
        .assessment-card { background: white; border-radius: 12px; padding: 30px; margin-top: -50px; box-shadow: 0 10px 30px rgba(0,0,0,0.1); border: 1px solid #e2e8f0; }
        
        .grid { display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px; }
        .field { display: flex; flex-direction: column; }
        label { font-size: 0.65rem; font-weight: 800; color: #64748b; text-transform: uppercase; margin-bottom: 5px; }
        input, select { padding: 12px; border: 1px solid #e2e8f0; border-radius: 6px; font-family: inherit; font-size: 1rem; }
        
        #results-area { display: none; margin-top: 30px; }
        .card { background: white; padding: 25px; border-radius: 12px; border: 1px solid #e2e8f0; margin-bottom: 20px; }
        .card-h { font-family: 'Oswald', sans-serif; text-transform: uppercase; border-bottom: 2px solid #f1f5f9; padding-bottom: 10px; margin-bottom: 15px; color: var(--navy); }
        .stat-row { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #f8fafc; font-weight: 700; }
        
        /* PDF Specific Styling (Hidden on Screen) */
        #pdf-template { display: none; padding: 40px; background: white; color: black; }
        .pdf-header { border-bottom: 4px solid black; padding-bottom: 10px; margin-bottom: 20px; text-transform: uppercase; }
        .pdf-section { border: 1px solid black; margin-bottom: 15px; padding: 15px; }
        .pdf-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; border-top: 1px solid black; margin-top: 10px; padding-top: 10px; }

        footer { position: fixed; bottom: 0; width: 100%; background: white; padding: 20px; border-top: 1px solid #e2e8f0; text-align: center; }
        .btn { background: var(--navy); color: white; border: none; padding: 15px 40px; border-radius: 8px; font-family: 'Oswald', sans-serif; text-transform: uppercase; cursor: pointer; font-size: 1rem; }
    </style>
</head>
<body>

<div id="ui-container">
    <header>
        <div class="squadron">HSM-77 Saberhawks</div>
        <h1>Performance Planner</h1>
    </header>

    <div class="container">
        <div class="assessment-card">
            <div class="grid">
                <div class="field"><label>Biological Sex</label><select id="sex"><option value="male">Male</option><option value="female">Female</option></select></div>
                <div class="field"><label>Run Capacity</label><select id="runCap">
                    <option value="15">15 Min (Initial)</option>
                    <option value="30">30 Min (Steady)</option>
                    <option value="45">45 Min (Endurance)</option>
                    <option value="60">60 Min (Elite)</option>
                </select></div>
                <div class="field"><label>Current 1.5M</label><input type="text" id="curRun" placeholder="e.g. 13:00"></div>
            </div>
            <div class="grid">
                <div class="field"><label>Goal 1.5M</label><input type="text" id="goalRun" placeholder="e.g. 10:30"></div>
                <div class="field"><label>Goal Push-ups</label><input type="number" id="goalPush"></div>
                <div class="field"><label>Goal Plank</label><input type="text" id="goalPlank"></div>
            </div>
            <button class="btn" style="width:100%" onclick="process()">Generate Strategic Plan</button>
        </div>

        <div id="results-area">
            <div class="card">
                <div class="card-h">Performance Analysis</div>
                <div class="stat-row"><span>NAFA Pace/Lap</span> <span id="res-lap" style="color:var(--red)">--:--</span></div>
                <div class="stat-row"><span>Treadmill Option (1.0%)</span> <span id="res-tread">-- MPH</span></div>
                <div id="points-stake" style="font-size: 0.8rem; color: #64748b; margin-top: 10px;"></div>
            </div>
            <div id="weekly-preview"></div>
        </div>
    </div>
</div>

<footer>
    <button class="btn" onclick="exportTacticalPDF()">Export High-Res Tactical PDF</button>
</footer>

<div id="pdf-template">
    <div class="pdf-header">
        <div style="font-weight: 900; font-size: 1.5rem;">HSM-77 Performance SOP</div>
        <div style="font-size: 0.8rem;">Strategic PRT Training & Pacing Intelligence</div>
    </div>
    
    <div class="pdf-section">
        <div style="font-weight: 800; font-size: 0.7rem; text-transform: uppercase;">Atsugi Operational Targets</div>
        <div class="pdf-grid">
            <div>Goal Run: <br><strong id="p-run"></strong></div>
            <div>Lap Split: <br><strong id="p-lap"></strong></div>
            <div>Treadmill: <br><strong id="p-tread"></strong></div>
        </div>
    </div>

    <div id="p-plan-content"></div>
</div>

<script>
    function process() {
        const goalRun = document.getElementById('goalRun').value;
        const cap = parseInt(document.getElementById('runCap').value);
        
        // Split Calculation
        const t = goalRun.split(':');
        const totalSec = (parseInt(t[0]) * 60) + parseInt(t[1]);
        const lapSec = totalSec / 7;
        const mph = (1.5 / (totalSec / 3600)).toFixed(1);
        
        const lapStr = Math.floor(lapSec/60) + ":" + (Math.round(lapSec%60) < 10 ? '0':'') + Math.round(lapSec%60);
        
        // Update UI
        document.getElementById('res-lap').innerText = lapStr + " / LAP";
        document.getElementById('res-tread').innerText = mph + " MPH";
        
        // Update PDF Template Data
        document.getElementById('p-run').innerText = goalRun;
        document.getElementById('p-lap').innerText = lapStr;
        document.getElementById('p-tread').innerText = mph + " MPH @ 1.0%";

        // Generate 4-Week Physiological Programming
        const microCycle = generateMicroCycle(cap, lapStr);
        let planHtml = "";
        
        for(let w=1; w<=4; w++) {
            planHtml += `
                <div style="margin-top:20px; border-bottom: 2px solid #eee; padding-bottom:10px;">
                    <strong style="text-transform:uppercase; font-size: 0.9rem;">Week ${w}: ${getPhase(w)}</strong>
                    <div style="font-size:0.8rem; margin-top:5px; line-height:1.4;">${microCycle}</div>
                </div>`;
        }
        document.getElementById('p-plan-content').innerHTML = planHtml;
        document.getElementById('results-area').style.display = 'block';
    }

    function getPhase(w) {
        const phases = ["Base Accumulation", "Threshold Extension", "Peak Intensity", "Taper & Supercompensation"];
        return phases[w-1];
    }

    function generateMicroCycle(cap, lap) {
        if (cap <= 15) return "<strong>MON:</strong> 4x400m Intervals @ ${lap} pace (2m rest).<br><strong>TUE:</strong> 4x12 Push-ups (Lockout Focus) + 2x1m Plank.<br><strong>WED:</strong> 25m Steady Jog (Zone 2).<br><strong>THU:</strong> Active Recovery Incline Walk (1.0%).<br><strong>FRI:</strong> 1-mile continuous @ 95% Goal Pace.";
        if (cap <= 30) return "<strong>MON:</strong> 6x400m Intervals @ ${lap} pace (90s rest).<br><strong>TUE:</strong> EMOM 10m: 12 Push-ups (Speed focus).<br><strong>WED:</strong> 35m Aerobic Base Run.<br><strong>THU:</strong> 3x800m Threshold @ Goal Pace + 5s.<br><strong>FRI:</strong> 10x200m Sprints (Neuromuscular recruitment).";
        return "<strong>MON:</strong> 8x400m Intervals @ ${lap} - 2s (60s rest).<br><strong>TUE:</strong> Volume Strength: 100 Reps total (Min sets).<br><strong>WED:</strong> 45m Recovery Run.<br><strong>THU:</strong> 4x800m Pace Extension @ Goal Pace.<br><strong>FRI:</strong> 2-mile Negative Split Run (Finish @ Goal Pace).";
    }

    function exportTacticalPDF() {
        const element = document.getElementById('pdf-template');
        element.style.display = 'block'; // Temporarily show for capture
        const opt = {
            margin: 0.5,
            filename: 'HSM77_Tactical_Plan.pdf',
            image: { type: 'jpeg', quality: 0.98 },
            html2canvas: { scale: 3 },
            jsPDF: { unit: 'in', format: 'letter', orientation: 'portrait' }
        };
        html2pdf().set(opt).from(element).save().then(() => {
            element.style.display = 'none';
        });
    }
</script>
</body>
</html>
